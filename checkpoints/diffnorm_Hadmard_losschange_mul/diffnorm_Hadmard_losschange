
  #Hadamard product
  cat_map_output = map_iterator(x,random_t)
  nornmalized_cmap = cat_map_output / std[:, None, None, None]
 
  
  perturbed_x = x + (z * std[:, None, None, None]) * (nornmalized_cmap)


 loss = torch.mean(torch.sum((score * std[:, None, None, None] + z * nornmalized_cmap)**2, dim=(1,2,3)))
  

102% loss -> did not decrease in a steady way.
